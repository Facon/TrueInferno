<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Galeon: Parseador de ficheros de mapas</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Galeon
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generado por Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Página&#160;principal</span></a></li>
      <li><a href="pages.html"><span>Páginas&#160;relacionadas</span></a></li>
      <li class="current"><a href="modules.html"><span>Módulos</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Estructuras&#160;de&#160;Datos</span></a></li>
      <li><a href="files.html"><span>Archivos</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Estructuras de datos</a>  </div>
  <div class="headertitle">
<div class="title">Parseador de ficheros de mapas</div>  </div>
</div><!--header-->
<div class="contents">

<p>Para la taréa del parseo de ficheros con definiciones de mapas se tiene el proyecto <a class="el" href="namespace_map.html" title="Namespace con todo lo relacionado con el parseado de mapas. ">Map</a> en el que se analizan léxica y sintácticamente los mapas descritos en ficheros para extraer de ellos la lista de descripciones de las entidades.  
<a href="#details">Más...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Diagrama de colaboración para Parseador de ficheros de mapas:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<center><table><tr><td><img src="group__map_parser_group.png" border="0" alt="" usemap="#group____map__parser__group"/>
<map name="group____map__parser__group" id="group____map__parser__group">
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Estructuras de datos</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_map_1_1_c_entity.html">Map::CEntity</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clase que representa una entidad leida del fichero del mapa.  <a href="class_map_1_1_c_entity.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_map_1_1_c_map_parser.html">Map::CMapParser</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">La clase <a class="el" href="class_map_1_1_c_map_parser.html" title="La clase CMapParser reune todos los componentes necesarios para el parseo de un mapa. ">CMapParser</a> reune todos los componentes necesarios para el parseo de un mapa.  <a href="class_map_1_1_c_map_parser.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_map_1_1_c_scanner.html">Map::CScanner</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_map_1_1_c_scanner.html" title="CScanner es una clase que dota de funcionalidades extra a la clase automáticamente generada por Flex ...">CScanner</a> es una clase que dota de funcionalidades extra a la clase automáticamente generada por Flex CMapFlexLexer.  <a href="class_map_1_1_c_scanner.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Descripción detallada</h2>
<p>Para la taréa del parseo de ficheros con definiciones de mapas se tiene el proyecto <a class="el" href="namespace_map.html" title="Namespace con todo lo relacionado con el parseado de mapas. ">Map</a> en el que se analizan léxica y sintácticamente los mapas descritos en ficheros para extraer de ellos la lista de descripciones de las entidades. </p>
<p>El grueso del proyecto se trata de código autogenerado por Flex y Bison (predecesores de Lex y Yacc), por lo que ese código <em>no</em> deberá ser modificado y si se desea cambiar la gramática se deberán modificar los ficheros con las descripciones de las gramáticas léxica y sintáctica (Map/Scanner.ll y Map/Parser.yy) y generar de nuevo a partir de ellos los ficheros. Para este fin se encuentra información extra en Map/Readme.txt. </p>
<p>Los mapas leidos por este parseador deberán seguir la siguiente estructura:</p>
<div class="fragment"><div class="line"><a class="code" href="namespace_map.html">Map</a> = {</div><div class="line">   [</div><div class="line">   EntityName = {</div><div class="line">      [AttributeName = AttributeValue,]*</div><div class="line">   },</div><div class="line">   ]*</div><div class="line">}</div></div><!-- fragment --><p>Por ejemplo:</p>
<div class="fragment"><div class="line"><a class="code" href="namespace_map.html">Map</a> = {</div><div class="line">   gobling1 = {</div><div class="line">      type = <span class="stringliteral">&quot;Gobling&quot;</span>,</div><div class="line">      position = {1.4,0,2.66},</div><div class="line">      life = 100.0,</div><div class="line">      ...</div><div class="line">   },</div><div class="line">   orc1 = {</div><div class="line">      type = <span class="stringliteral">&quot;Orc&quot;</span></div><div class="line">      modelname = <span class="stringliteral">&quot;orc.mesh&quot;</span>,</div><div class="line">      ...</div><div class="line">   }</div><div class="line">   ...</div><div class="line">}</div></div><!-- fragment --><p>Donde los nombres de los atributos deben empezar por una letra o '_' y contener letras, números o '_' y los valores de los atriburos pueden ser cadenas encerradas entre dobles comillas '"', numeros enteros o reales, "true", "false" o posiciones tipo "{x,y,z}". No obstante todos los valores de atributos serán almacenados como strings y será luego, durante el spawn de las entidaes cuando los componentes deban saber que tipo de datos esperan de cada atributo concreto para recuperar los atributos con su tipo correcto mediante los métodos getXXXAttribute() de <a class="el" href="class_map_1_1_c_entity.html" title="Clase que representa una entidad leida del fichero del mapa. ">Map::CEntity</a>. Los tipos de las entidades deben coincidir con las declaradas en los archivos de blueprints, aunque no se hará ningún tipo de comprobación aquí. Eso si, toda entidad declarada deberá como mínimo tener el atributo de nombre "type" y los nombres de las entidades deberán ser diferentes entre sí. Estas comprobaciones solo se realizan en modo Debug, por optimización del código Release. Como curiosidad cabe decir que los saltos de línea, espacios y tabulaciones son opcionales y que puede usarse ';' en vez de ',' como separador si se prefiere. </p>
<p>La clase CMapParser reune todos los componentes necesarios para el parseo de un mapa. Es un singleton de inicialización explícita que permite parseo de streams. No obstante incluye métodos que facilitan el parseo de un archivo dado su nombre, o de un string. Su uso más común será mediante la lectura de un fichero con <a class="el" href="class_map_1_1_c_map_parser.html#aad5c152f4f2270ea2ad57badbe46504f" title="Crea un CParser y un CScanner para parsear un mapa dado en un nombre de fichero. ">Map::CMapParser::parseFile()</a> que leerá el fichero de nombre especificado que se encuentre en la ruta <code>Exes/media/maps</code> y creará una lista de <a class="el" href="class_map_1_1_c_entity.html" title="Clase que representa una entidad leida del fichero del mapa. ">Map::CEntity</a>'s con las descripciones de las entidades. </p>
<p><a class="el" href="class_map_1_1_c_entity.html" title="Clase que representa una entidad leida del fichero del mapa. ">Map::CEntity</a> no es más que una clase contenedora de atributos tipo par &lt;std::string,std::string&gt; donde el primer elemento es el nombre del atributo es el nombre del atributo y el segundo elemento es su valor codificado en un string. Además contiene una serie de métodos que permiten recuperar los valores de los atributos ya transformados a un tipo concreto (int, float, double, bool, string o Vector3). </p>
<p>El parseador de mapas es usado por la función estática <a class="el" href="class_logic_1_1_c_map.html#a78c93d843a8476efee42030e2767c025" title="Método factoría que carga un mapa de fichero. ">Logic::CMap::createMapFromFile()</a>, allí se puede ver más claramente como generar un mapa lógico a partir de las definiciones de entidades (<a class="el" href="class_map_1_1_c_entity.html" title="Clase que representa una entidad leida del fichero del mapa. ">Map::CEntity</a>) devueltas por este módulo.</p>
<dl class="section author"><dt>Autor</dt><dd>David Llansó </dd></dl>
<dl class="section date"><dt>Fecha</dt><dd>Septiembre, 2010 </dd></dl>
</div><!-- contents -->
<hr size="1"/>
<address style="text-align: left;"><small>
David Llansó, Marco Antonio Gómez Martín.<p/>
(c) <a href="http://www.videojuegos-ucm.es/">Master en Desarrollo de Videojuegos</a>, <a href="http://www.ucm.es">UCM</a>.<p/>
Documentación generada con <a href="http://www.doxygen.org/index.html">Doxygen</a>
</small></address>
