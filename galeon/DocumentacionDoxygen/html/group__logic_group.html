<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Galeon: Lógica de juego</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Galeon
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generado por Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Página&#160;principal</span></a></li>
      <li><a href="pages.html"><span>Páginas&#160;relacionadas</span></a></li>
      <li class="current"><a href="modules.html"><span>Módulos</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Estructuras&#160;de&#160;Datos</span></a></li>
      <li><a href="files.html"><span>Archivos</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#files">Archivos</a> &#124;
<a href="#nested-classes">Estructuras de datos</a>  </div>
  <div class="headertitle">
<div class="title">Lógica de juego</div>  </div>
</div><!--header-->
<div class="contents">

<p>La lógica de juego son las reglas del juego que se quiere implementar; aquí es donde se definen conceptos como que tipo de juego se va a realizar, sus reglas, que entidades habrá, como se crearán y organizarán, como se comportarán, etc.  
<a href="#details">Más...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Diagrama de colaboración para Lógica de juego:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<center><table><tr><td><img src="group__logic_group.png" border="0" alt="" usemap="#group____logic__group"/>
<map name="group____logic__group" id="group____logic__group">
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Archivos</h2></td></tr>
<tr class="memitem:_tile_manager_8h"><td class="memItemLeft" align="right" valign="top">archivo &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tile_manager_8h.html">TileManager.h</a></td></tr>
<tr class="memdesc:_tile_manager_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">THIS IS A TEMPLATE OF AN EMPTY SINGLETON MANAGER, CONTAINING ONLY THE MANAGER INSTANCE AND ALL REQUIRED FUNCTIONS FOR INITIALIZATION AND DESTRUCTION OF STATIC RESOURCES. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Estructuras de datos</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_i_component.html">Logic::IComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clase base de los componentes que forman las entidades.  <a href="class_logic_1_1_i_component.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_animated_graphics.html">Logic::CAnimatedGraphics</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Componente que se encarga de la representaciï¿œn grï¿œfica animada de una entidad.  <a href="class_logic_1_1_c_animated_graphics.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_avatar_controller.html">Logic::CAvatarController</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Este componente es el encargado de mover a una entidad animada.  <a href="class_logic_1_1_c_avatar_controller.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_camera.html">Logic::CCamera</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Componente que se encarga de mover la cï¿œmara grï¿œfica de una escena, para que ï¿œsta se pueda reenderizar, siguiendo al jugador.  <a href="class_logic_1_1_c_camera.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_damage_trigger.html">Logic::CDamageTrigger</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Este componente procesa mensajes de tipo TOUCHED (indican que la entidad ha sido tocada) para enviar un mensaje DAMAGED a la entidad que tocï¿œ.  <a href="class_logic_1_1_c_damage_trigger.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_graphics.html">Logic::CGraphics</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Componente que se encarga de la representaciï¿œn grï¿œfica de una entidad.  <a href="class_logic_1_1_c_graphics.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_life.html">Logic::CLife</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Este componente controla la vida de una entidad.  <a href="class_logic_1_1_c_life.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_physic_controller.html">Logic::CPhysicController</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Componente que se utiliza para representar jugadores y enemigos en el mundo fï¿œsico usando character controllers.  <a href="class_logic_1_1_c_physic_controller.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_physic_entity.html">Logic::CPhysicEntity</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Componente encargardo de la representaciï¿œn fï¿œsica de una entidad simple.  <a href="class_logic_1_1_c_physic_entity.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_i_physics.html">Logic::IPhysics</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clase abstracta de la que deben heredar todos los componentes fï¿œsicos.  <a href="class_logic_1_1_i_physics.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_ray_perception.html">Logic::CRayPerception</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Este componente lanza un rayo en la direcciï¿œn en la que mira la entidad para comprobar si alguna otra entidad estï¿œ cerca.  <a href="class_logic_1_1_c_ray_perception.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_switch_position.html">Logic::CSwitchPosition</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Este componente controla el movimiento de una entidad que tiene dos estados (posiciones) y la mueve de uno a otro.  <a href="class_logic_1_1_c_switch_position.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_switch_trigger.html">Logic::CSwitchTrigger</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Este componente procesa mensajes de tipo TOUCHED o UNTOUCHED (indican que la entidad ha sido tocada o dejada de ser tocada) para enviar un mensaje SWITCH a una entidad objetivo.  <a href="class_logic_1_1_c_switch_trigger.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_entity.html">Logic::CEntity</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clase que representa una entidad en el entorno virtual.  <a href="class_logic_1_1_c_entity.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_message.html">Logic::Message</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contiene el tipo de datos de un mensaje.  <a href="class_logic_1_1_message.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_component_factory.html">Logic::CComponentFactory</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Factoría de componentes.  <a href="class_logic_1_1_c_component_factory.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_entity_factory.html">Logic::CEntityFactory</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Factoría de <a class="el" href="class_logic_1_1_c_entity.html" title="Clase que representa una entidad en el entorno virtual. ">CEntity</a> que centraliza tanto la construcción como la destrucción de entidades del juego.  <a href="class_logic_1_1_c_entity_factory.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_entity_i_d.html">Logic::EntityID</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clase que gestiona la generación de nuevos identificadores.  <a href="class_logic_1_1_entity_i_d.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_building_manager.html">Logic::CBuildingManager</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manager singleton que gestiona las operaciones con los edificios del mapa.  <a href="class_logic_1_1_c_building_manager.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_tile_manager.html">Logic::CTileManager</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manager singleton que gestiona la lectura y actualización de la matriz de tiles del mapa.  <a href="class_logic_1_1_c_tile_manager.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_map.html">Logic::CMap</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clase que representa un mapa lógico.  <a href="class_logic_1_1_c_map.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_logic_1_1_c_server.html">Logic::CServer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Servidor de la lógica que se se encarga de la creación del mundo, su destrucción y actualización a lo largo de la partida.  <a href="class_logic_1_1_c_server.html#details">Más...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Descripción detallada</h2>
<p>La lógica de juego son las reglas del juego que se quiere implementar; aquí es donde se definen conceptos como que tipo de juego se va a realizar, sus reglas, que entidades habrá, como se crearán y organizarán, como se comportarán, etc. </p>
<p>La lógica inicialmente planteada corresponde a un juego en tiempo real en tercera persona. Inicialmente no se ha añadido ningún tipo de regla de juego extra y puede servir como punto de partida para diferentes proyectos de este tipo de juegos o de otro tipo de juegos con alguna modificación. </p>
<p>Las entidades de lógica propuestas se basan en una arquitectura de componentes (ver <a class="el" href="group__entity_group.html">Entidades en la lógica de juego</a>) y para su creación y organización se tiene un mapa lógico (ver <a class="el" href="group__map_group.html">Mapas de entidades lógicas</a>) que carga un mapa de fichero que contiene todas las entidades con sus atributos. </p>
<p>El acceso a la lógica del juego está centralizada en <a class="el" href="class_logic_1_1_c_server.html" title="Servidor de la lógica que se se encarga de la creación del mundo, su destrucción y actualización a lo...">Logic::CServer</a>, un singleton de inicialización explícita. Éste nos permite cargar un nivel a partir de un fichero con una definición de mapa, que deberá luego activarse al comienzo de la partida. Cuando la partida está activa el servidor debe ser actualizado periodicamente para que se actualice el mapa y por tanto todas las entidades puedan actuar y realizar sus acciones. En la implementación que se ha llevado a cabo solo permitimos tener un mapa o nivel cargado, por lo que si se desea cargar otro nivel se borrará el anterior. Esto conlleva a que los métodos de gestión de mapas que tiene el servidor sean triviales. Si se quisiesen realizar implementaciones donde se permitan multiples mapas o niveles cargados al mismo tiempo habría que revisar la implementación de los métodos de gestion de mapas del servidor. </p>
<p>Falta comentar que para poder cargar correctamente las entidades del mapa es necesario que se encuentren cargadas las definiciones blueprints de todas las entidades por componentes que se quieren permitir. </p>
<p>El orden cronológico de las llamadas a la lógica vendría marcado por el siguiente marco, aunque obviamente las llamadas reales no se realizan todas juntas sino que dependen del estado de juego de la aplicación y sus diferentes métodos (se puede ver un ejemplo en <a class="el" href="class_application_1_1_c_game_state.html" title="Clase CGameState; representa el estado de juego de la aplicación. ">Application::CGameState</a>): </p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (!<a class="code" href="class_logic_1_1_c_server.html#a80fa02eb6a6dd105aca546cbf8e7e93a">Logic::CServer::Init</a>())</div><div class="line">    <span class="keywordflow">return</span>;</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (!<a class="code" href="class_logic_1_1_c_entity_factory.html#a5ffb69281f3ba1803276443bff22e964">Logic::CEntityFactory::getSingletonPtr</a>()-&gt;loadBluePrints(<span class="stringliteral">&quot;blueprints.txt&quot;</span>))</div><div class="line">    <span class="keywordflow">return</span>;</div><div class="line"></div><div class="line"><a class="code" href="class_logic_1_1_c_server.html#a6f7538360ea983bd1e81d0c988c14b27">Logic::CServer::getSingletonPtr</a>()-&gt;<a class="code" href="class_logic_1_1_c_server.html#a07338753f946c3d59a76f794594a0158">loadLevel</a>(<span class="stringliteral">&quot;map.txt&quot;</span>);</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">Logic::CServer::getSingletonPtr()-&gt;activateMap();</div><div class="line"></div><div class="line"><span class="keywordflow">while</span>(...)</div><div class="line">{</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">Logic::CServer::getSingletonPtr()-&gt;tick(timeSinceLastFrame);</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="class_logic_1_1_c_server.html#a6f7538360ea983bd1e81d0c988c14b27">Logic::CServer::getSingletonPtr</a>()-&gt;<a class="code" href="class_logic_1_1_c_server.html#a6c8e7e8bb7655ed7fcdb0414cf1c8030">deactivateMap</a>();</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">Logic::CServer::getSingletonPtr()-&gt;unLoadLevel();</div><div class="line"></div><div class="line"><a class="code" href="class_logic_1_1_c_entity_factory.html#a5ffb69281f3ba1803276443bff22e964">Logic::CEntityFactory::getSingletonPtr</a>()-&gt;<a class="code" href="class_logic_1_1_c_entity_factory.html#a860f5ea85c7df83d8da6e932f96413e4">unloadBluePrints</a>();</div><div class="line"></div><div class="line"><a class="code" href="class_logic_1_1_c_server.html#a092004ad9f1e4f973bd6dbcc2b12b944">Logic::CServer::Release</a>();</div></div><!-- fragment --><dl class="section author"><dt>Autor</dt><dd>David Llansó </dd></dl>
<dl class="section date"><dt>Fecha</dt><dd>Septiembre, 2010 </dd></dl>
</div><!-- contents -->
<hr size="1"/>
<address style="text-align: left;"><small>
David Llansó, Marco Antonio Gómez Martín.<p/>
(c) <a href="http://www.videojuegos-ucm.es/">Master en Desarrollo de Videojuegos</a>, <a href="http://www.ucm.es">UCM</a>.<p/>
Documentación generada con <a href="http://www.doxygen.org/index.html">Doxygen</a>
</small></address>
